---
title: 멀티 스레딩과 게임 엔진
date: 2018-10-10
categories:
- Development
tags:
- Development
- Game
---

 단일코어를 넘어 듀얼코어, 쿼드코어 CPU가 생산되고, 현재는 그보다 더 많은 수의 코어를 지원하는 CPU도 개발되었다. 멀티 코어의 시대가 찾아온 것이다. 이런 시대의 흐름에 따라 다수의 유저들은 멀티코어 CPU를 택하기 시작했다.

 하지만 멀티코어를 사용한다고 해서 무조건 적인 성능 향상이 일어나진 않는다. 하드웨어의 스펙이 좋다고 하더라도 소프트웨어가 그 스펙을 지원해줘야 하기 때문이다. 대다수의 게임들 또한 멀티코어 CPU가 개발된 후에도 제대로 이를 지원하지 못했다. ~~최근에도 일반적인 게임들이 쿼드코어보다 많은 코어를 갖춘 CPU를 제대로 지원하지 않아 유저들이 쿼드코어를 CPU로 선택하는 것이 일반적이다~~

 그 이유는 개발자들이 게으른 것이 아니라 게임이 갖는 구조적 특성에 있다. 게임은 프레임 단위로 로직들을 수행하고 로직들이 끝난 후 최신의 정보를 가지고 화면을 다시 그리게 된다. 시간당 많은 프레임이 존재할 수록 화면이 사람의 눈에 부드럽게 인식되고 이 단위를 FPS<sup>Frame Per Second</sup>라고 한다.

![multithreading-game-engine-0](https://user-images.githubusercontent.com/18159012/46985243-5f23a700-d124-11e8-9ab1-3d9cceb30a93.gif)

 게임이 프레임 단위로 수행되기 때문에 한 프레임 안에서 충돌처리, 애니메이션, 게임 로직, 랜더링 등 많은 기능들이 작동이 되어야했다.



다른 프로그램에선 불필요하게 화면을 다시 그리는 작업을 하지 않기 위해 표시되는 데이터가 갱신되었을 때만 화면을 다시 그리는데, 게임에선 매순간 데이터가 갱신된다.

[그림 - 게임과 일반 프로그램 비교]

 

 게임에서 FPS<sup>Frame Per Second</sup>는 초당 몇번 화면(프레임)을 몇 번 그려지는 지를 의미하며, 게임 성능의 지표가된다. FPS라는 단어에서 알 수 있듯이 업데이트된 데이터가 있을 때에만 화면을 다시 그리는 일반적인 프로그램과는 다르게 



하지만 최근들어 이런 시류에 변화의 조짐이 드러나기 시작했다. 코어의 갯수에 따라 퍼포먼스에 차이가 나는 '멀티코어 지원' 게임들이 나타나기 시작했고, AMD가 새롭게 출시한 CPU 라이젠은 제대로 된 헥사코어, 옥타코어 시대를 열었다. 게이머들이 다중코어의 유리함을 조금씩 깨닫기 시작한 것이다.

이런 게이밍 PC 시장에서 일고 있는 다중코어 CPU 열기에 인텔이 불을 지폈다. 인텔이 쿼드코어 이상의 코어 갯수를 지닌 CPU들이 게임에서 보다 나은 퍼포먼스를 낼 수 있는 패치를 낼 것이라는 예고를 한 것이 그 이유다.

코어 갯수가 많은 CPU에서 고품질의 더욱 다양한 효과를 지원하도록 하는 것이 인텔이 이야기한 패치의 핵심 내용이다. 

하지만 인텔의 이런 발표가 마냥 낙관적인 것은 아니다. 인텔이 쿼드코어 이상의 다중코어 CPU에 게이밍 성능을 높일 계획이라 하더라도, 현재 출시된 게임에 대한 사후지원은 게임 개발사가 패치로 진행해야 하는 일이기 때문이다. 

즉, 인텔이 그리고 있는 청사진은 게임업계의 도움이 있어야만 가능한 일인데, 인텔이 이에 대한 어느 정도의 자금지원을 할 것인지가 관건이다.

또한, 추후 출시되는 게임에 대해서만 다중코어 CPU 지원이 적극적으로 진행될 것이라는 관측도 나오고 있다. 이미 완성된 게임의 병렬화 작업이 쉬운 일이 아니기 때문이다. 게다가 지금까지 인텔이 게임 제작사를 대상으로 직접 지원을 한 사례가 드물었기 때문에 인텔의 이번 발표가 현실적으로 와닿지 않는다는 것이 업계 관계자들의 이야기다.

```java
int cores = Runtime.getRuntime().availableProcessors();
// This will give you the number of logical threads. e.g. If you have hyper-threading on, this will be double the number of cores.
```



참조:

https://www.youtube.com/watch?v=M1e9nmmD3II